> # select number
> waterBIC <- mclustBIC(water_scale)
fitting ...
  |=========================================| 100%
> waterBIC
Bayesian Information Criterion (BIC): 
        EII       VII       EEI       VEI
1 -445.1212 -445.1212 -469.4936 -469.4936
2 -386.4165 -389.0900 -367.8193 -370.4629
3 -378.4382 -358.8093 -347.1057 -329.5650
4 -358.6544 -351.4829 -340.3512 -316.0606
5 -370.6835        NA -349.4615        NA
6 -381.3568        NA -368.2651        NA
7 -368.0075        NA -362.6760        NA
8 -364.8526        NA -332.9501        NA
9 -323.4337        NA -272.9024        NA
        EVI       VVI       EEE       EVE
1 -469.4936 -469.4936 -281.4741 -281.4741
2 -353.6059 -356.1762 -260.0105        NA
3        NA        NA -233.3034        NA
4        NA        NA -204.7450        NA
5        NA        NA -149.1606        NA
6        NA        NA        NA        NA
7        NA        NA        NA        NA
8        NA        NA        NA        NA
9        NA        NA        NA        NA
        VEE       VVE       EEV       VEV
1 -281.4741 -281.4741 -281.4741 -281.4741
2        NA        NA        NA        NA
3        NA        NA        NA        NA
4        NA        NA        NA        NA
5        NA        NA        NA        NA
6        NA        NA        NA        NA
7        NA        NA        NA        NA
8        NA        NA        NA        NA
9        NA        NA        NA        NA
        EVV       VVV
1 -281.4741 -281.4741
2        NA        NA
3        NA        NA
4        NA        NA
5        NA        NA
6        NA        NA
7        NA        NA
8        NA        NA
9        NA        NA

Top 3 models based on the BIC criterion: 
    EEE,5     EEE,4     EEE,3 
-149.1606 -204.7450 -233.3034 
> plot(waterBIC)
> # clustering
> watermod <- Mclust(water_scale)
fitting ...
  |=========================================| 100%
> summary(watermod, parameters = TRUE)
--------------------------------------------------- 
Gaussian finite mixture model fitted by EM
algorithm 
--------------------------------------------------- 

Mclust EEE (ellipsoidal, equal volume, shape and
orientation) model with 5 components: 

 log-likelihood  n  df       BIC       ICL
       73.00845 15 109 -149.1606 -149.1606

Clustering table:
1 2 3 4 5 
1 4 2 5 3 

Mixing probabilities:
         1          2          3          4 
0.06666667 0.26666667 0.13333333 0.33333333 
         5 
0.20000000 

Means:
                     [,1]       [,2]       [,3]
BOD            0.70703684  0.2883966 -2.0838980
COD           -1.01692064 -0.8529012 -0.2788331
T.N            1.63876655  0.5838787  0.6099954
DTN           -0.02916391  0.6572433  0.8515095
NO3.N         -0.08617910  0.6730366  0.9522474
NH3.N          1.60237055  0.1380193  0.7540567
T.P            1.03470213  1.0927011  0.7911063
DTP            1.29713811  1.1510382  0.3861621
PO4.P          0.89952101  1.2010364  0.5791609
Chlorophyll.a  0.37343728  1.4850869 -0.8970194
                     [,4]       [,5]
BOD           -0.07442493  0.8930992
COD            0.32803892  1.1153323
T.N           -1.14368464  0.1747170
DTN           -1.20339514  0.5713824
NO3.N         -0.97870309  0.1276845
NH3.N         -0.83754158  0.1750489
T.P           -0.85374526 -0.9063310
DTP           -0.77919957 -0.9258724
PO4.P         -0.84926844 -0.8718821
Chlorophyll.a -0.63715330 -0.4446599

Variances:
[,,1]
                      BOD         COD          T.N
BOD            0.13743818  0.02685570 -0.045401684
COD            0.02685570  0.37537791 -0.078267837
T.N           -0.04540168 -0.07826784  0.171663140
DTN           -0.05024687 -0.10309592  0.167098542
NO3.N         -0.07292539 -0.16155010  0.236042723
NH3.N          0.09437785 -0.18711014 -0.155172172
T.P            0.02103609 -0.01676819  0.058497231
DTP            0.05387701  0.02589908 -0.012632866
PO4.P          0.03955097  0.01726783  0.021915326
Chlorophyll.a  0.04118814 -0.02778395  0.002244068
                      DTN        NO3.N
BOD           -0.05024687 -0.072925388
COD           -0.10309592 -0.161550103
T.N            0.16709854  0.236042723
DTN            0.17339363  0.239067355
NO3.N          0.23906735  0.368593419
NH3.N         -0.14337842 -0.165358975
T.P            0.05464512  0.097932897
DTP           -0.02427341 -0.001637561
PO4.P          0.01998756  0.048277592
Chlorophyll.a  0.01198116  0.019307481
                     NH3.N         T.P
BOD            0.094377845  0.02103609
COD           -0.187110135 -0.01676819
T.N           -0.155172172  0.05849723
DTN           -0.143378420  0.05464512
NO3.N         -0.165358975  0.09793290
NH3.N          0.441313492 -0.02523899
T.P           -0.025238992  0.05286650
DTP            0.057239334  0.04114494
PO4.P          0.003978795  0.04871460
Chlorophyll.a  0.033449524  0.02908705
                       DTP       PO4.P
BOD            0.053877009 0.039550966
COD            0.025899083 0.017267827
T.N           -0.012632866 0.021915326
DTN           -0.024273407 0.019987560
NO3.N         -0.001637561 0.048277592
NH3.N          0.057239334 0.003978795
T.P            0.041144938 0.048714604
DTP            0.074143707 0.054304122
PO4.P          0.054304122 0.057548906
Chlorophyll.a  0.032016420 0.037907207
              Chlorophyll.a
BOD             0.041188144
COD            -0.027783950
T.N             0.002244068
DTN             0.011981163
NO3.N           0.019307481
NH3.N           0.033449524
T.P             0.029087054
DTP             0.032016420
PO4.P           0.037907207
Chlorophyll.a   0.053755693
[,,2]
                      BOD         COD          T.N
BOD            0.13743818  0.02685570 -0.045401684
COD            0.02685570  0.37537791 -0.078267837
T.N           -0.04540168 -0.07826784  0.171663140
DTN           -0.05024687 -0.10309592  0.167098542
NO3.N         -0.07292539 -0.16155010  0.236042723
NH3.N          0.09437785 -0.18711014 -0.155172172
T.P            0.02103609 -0.01676819  0.058497231
DTP            0.05387701  0.02589908 -0.012632866
PO4.P          0.03955097  0.01726783  0.021915326
Chlorophyll.a  0.04118814 -0.02778395  0.002244068
                      DTN        NO3.N
BOD           -0.05024687 -0.072925388
COD           -0.10309592 -0.161550103
T.N            0.16709854  0.236042723
DTN            0.17339363  0.239067355
NO3.N          0.23906735  0.368593419
NH3.N         -0.14337842 -0.165358975
T.P            0.05464512  0.097932897
DTP           -0.02427341 -0.001637561
PO4.P          0.01998756  0.048277592
Chlorophyll.a  0.01198116  0.019307481
                     NH3.N         T.P
BOD            0.094377845  0.02103609
COD           -0.187110135 -0.01676819
T.N           -0.155172172  0.05849723
DTN           -0.143378420  0.05464512
NO3.N         -0.165358975  0.09793290
NH3.N          0.441313492 -0.02523899
T.P           -0.025238992  0.05286650
DTP            0.057239334  0.04114494
PO4.P          0.003978795  0.04871460
Chlorophyll.a  0.033449524  0.02908705
                       DTP       PO4.P
BOD            0.053877009 0.039550966
COD            0.025899083 0.017267827
T.N           -0.012632866 0.021915326
DTN           -0.024273407 0.019987560
NO3.N         -0.001637561 0.048277592
NH3.N          0.057239334 0.003978795
T.P            0.041144938 0.048714604
DTP            0.074143707 0.054304122
PO4.P          0.054304122 0.057548906
Chlorophyll.a  0.032016420 0.037907207
              Chlorophyll.a
BOD             0.041188144
COD            -0.027783950
T.N             0.002244068
DTN             0.011981163
NO3.N           0.019307481
NH3.N           0.033449524
T.P             0.029087054
DTP             0.032016420
PO4.P           0.037907207
Chlorophyll.a   0.053755693
[,,3]
                      BOD         COD          T.N
BOD            0.13743818  0.02685570 -0.045401684
COD            0.02685570  0.37537791 -0.078267837
T.N           -0.04540168 -0.07826784  0.171663140
DTN           -0.05024687 -0.10309592  0.167098542
NO3.N         -0.07292539 -0.16155010  0.236042723
NH3.N          0.09437785 -0.18711014 -0.155172172
T.P            0.02103609 -0.01676819  0.058497231
DTP            0.05387701  0.02589908 -0.012632866
PO4.P          0.03955097  0.01726783  0.021915326
Chlorophyll.a  0.04118814 -0.02778395  0.002244068
                      DTN        NO3.N
BOD           -0.05024687 -0.072925388
COD           -0.10309592 -0.161550103
T.N            0.16709854  0.236042723
DTN            0.17339363  0.239067355
NO3.N          0.23906735  0.368593419
NH3.N         -0.14337842 -0.165358975
T.P            0.05464512  0.097932897
DTP           -0.02427341 -0.001637561
PO4.P          0.01998756  0.048277592
Chlorophyll.a  0.01198116  0.019307481
                     NH3.N         T.P
BOD            0.094377845  0.02103609
COD           -0.187110135 -0.01676819
T.N           -0.155172172  0.05849723
DTN           -0.143378420  0.05464512
NO3.N         -0.165358975  0.09793290
NH3.N          0.441313492 -0.02523899
T.P           -0.025238992  0.05286650
DTP            0.057239334  0.04114494
PO4.P          0.003978795  0.04871460
Chlorophyll.a  0.033449524  0.02908705
                       DTP       PO4.P
BOD            0.053877009 0.039550966
COD            0.025899083 0.017267827
T.N           -0.012632866 0.021915326
DTN           -0.024273407 0.019987560
NO3.N         -0.001637561 0.048277592
NH3.N          0.057239334 0.003978795
T.P            0.041144938 0.048714604
DTP            0.074143707 0.054304122
PO4.P          0.054304122 0.057548906
Chlorophyll.a  0.032016420 0.037907207
              Chlorophyll.a
BOD             0.041188144
COD            -0.027783950
T.N             0.002244068
DTN             0.011981163
NO3.N           0.019307481
NH3.N           0.033449524
T.P             0.029087054
DTP             0.032016420
PO4.P           0.037907207
Chlorophyll.a   0.053755693
[,,4]
                      BOD         COD          T.N
BOD            0.13743818  0.02685570 -0.045401684
COD            0.02685570  0.37537791 -0.078267837
T.N           -0.04540168 -0.07826784  0.171663140
DTN           -0.05024687 -0.10309592  0.167098542
NO3.N         -0.07292539 -0.16155010  0.236042723
NH3.N          0.09437785 -0.18711014 -0.155172172
T.P            0.02103609 -0.01676819  0.058497231
DTP            0.05387701  0.02589908 -0.012632866
PO4.P          0.03955097  0.01726783  0.021915326
Chlorophyll.a  0.04118814 -0.02778395  0.002244068
                      DTN        NO3.N
BOD           -0.05024687 -0.072925388
COD           -0.10309592 -0.161550103
T.N            0.16709854  0.236042723
DTN            0.17339363  0.239067355
NO3.N          0.23906735  0.368593419
NH3.N         -0.14337842 -0.165358975
T.P            0.05464512  0.097932897
DTP           -0.02427341 -0.001637561
PO4.P          0.01998756  0.048277592
Chlorophyll.a  0.01198116  0.019307481
                     NH3.N         T.P
BOD            0.094377845  0.02103609
COD           -0.187110135 -0.01676819
T.N           -0.155172172  0.05849723
DTN           -0.143378420  0.05464512
NO3.N         -0.165358975  0.09793290
NH3.N          0.441313492 -0.02523899
T.P           -0.025238992  0.05286650
DTP            0.057239334  0.04114494
PO4.P          0.003978795  0.04871460
Chlorophyll.a  0.033449524  0.02908705
                       DTP       PO4.P
BOD            0.053877009 0.039550966
COD            0.025899083 0.017267827
T.N           -0.012632866 0.021915326
DTN           -0.024273407 0.019987560
NO3.N         -0.001637561 0.048277592
NH3.N          0.057239334 0.003978795
T.P            0.041144938 0.048714604
DTP            0.074143707 0.054304122
PO4.P          0.054304122 0.057548906
Chlorophyll.a  0.032016420 0.037907207
              Chlorophyll.a
BOD             0.041188144
COD            -0.027783950
T.N             0.002244068
DTN             0.011981163
NO3.N           0.019307481
NH3.N           0.033449524
T.P             0.029087054
DTP             0.032016420
PO4.P           0.037907207
Chlorophyll.a   0.053755693
[,,5]
                      BOD         COD          T.N
BOD            0.13743818  0.02685570 -0.045401684
COD            0.02685570  0.37537791 -0.078267837
T.N           -0.04540168 -0.07826784  0.171663140
DTN           -0.05024687 -0.10309592  0.167098542
NO3.N         -0.07292539 -0.16155010  0.236042723
NH3.N          0.09437785 -0.18711014 -0.155172172
T.P            0.02103609 -0.01676819  0.058497231
DTP            0.05387701  0.02589908 -0.012632866
PO4.P          0.03955097  0.01726783  0.021915326
Chlorophyll.a  0.04118814 -0.02778395  0.002244068
                      DTN        NO3.N
BOD           -0.05024687 -0.072925388
COD           -0.10309592 -0.161550103
T.N            0.16709854  0.236042723
DTN            0.17339363  0.239067355
NO3.N          0.23906735  0.368593419
NH3.N         -0.14337842 -0.165358975
T.P            0.05464512  0.097932897
DTP           -0.02427341 -0.001637561
PO4.P          0.01998756  0.048277592
Chlorophyll.a  0.01198116  0.019307481
                     NH3.N         T.P
BOD            0.094377845  0.02103609
COD           -0.187110135 -0.01676819
T.N           -0.155172172  0.05849723
DTN           -0.143378420  0.05464512
NO3.N         -0.165358975  0.09793290
NH3.N          0.441313492 -0.02523899
T.P           -0.025238992  0.05286650
DTP            0.057239334  0.04114494
PO4.P          0.003978795  0.04871460
Chlorophyll.a  0.033449524  0.02908705
                       DTP       PO4.P
BOD            0.053877009 0.039550966
COD            0.025899083 0.017267827
T.N           -0.012632866 0.021915326
DTN           -0.024273407 0.019987560
NO3.N         -0.001637561 0.048277592
NH3.N          0.057239334 0.003978795
T.P            0.041144938 0.048714604
DTP            0.074143707 0.054304122
PO4.P          0.054304122 0.057548906
Chlorophyll.a  0.032016420 0.037907207
              Chlorophyll.a
BOD             0.041188144
COD            -0.027783950
T.N             0.002244068
DTN             0.011981163
NO3.N           0.019307481
NH3.N           0.033449524
T.P             0.029087054
DTP             0.032016420
PO4.P           0.037907207
Chlorophyll.a   0.053755693
> waterclassify <- cbind(water, watermod$classification)
> waterclassify
     BOD COD   T.N   DTN NO3.N NH3.N   T.P   DTP
2005 2.1 5.0 3.310 2.739 2.226 0.163 0.126 0.090
2006 2.0 5.1 3.206 2.924 2.495 0.112 0.127 0.079
2007 1.9 4.7 3.093 2.890 2.430 0.120 0.122 0.076
2008 2.0 5.0 2.984 2.807 2.291 0.148 0.119 0.084
2009 2.2 5.6 3.028 2.812 2.327 0.127 0.146 0.104
2010 1.6 5.4 3.057 2.868 2.402 0.159 0.118 0.069
2011 1.6 5.5 3.110 2.916 2.487 0.125 0.113 0.058
2012 1.9 5.6 2.911 2.687 2.369 0.088 0.070 0.041
2013 2.0 5.2 2.732 2.591 2.138 0.120 0.050 0.027
2014 2.2 5.5 3.011 2.872 2.310 0.149 0.044 0.026
2015 2.0 6.0 2.496 2.343 1.755 0.129 0.032 0.039
2016 2.1 6.6 2.922 2.792 2.250 0.131 0.040 0.025
2017 2.0 6.1 2.687 2.532 1.932 0.093 0.033 0.018
2018 2.1 6.8 3.030 2.866 2.253 0.103 0.043 0.025
2019 1.9 6.2 2.661 2.522 1.997 0.083 0.038 0.023
     PO4.P Chlorophyll.a watermod$classification
2005 0.060          28.2                       1
2006 0.060          32.8                       2
2007 0.062          35.2                       2
2008 0.066          36.6                       2
2009 0.084          39.0                       2
2010 0.055          19.4                       3
2011 0.048          19.4                       3
2012 0.026          21.8                       4
2013 0.015          23.8                       4
2014 0.012          23.6                       5
2015 0.009          20.1                       4
2016 0.013          20.4                       5
2017 0.008          19.4                       4
2018 0.014          23.6                       5
2019 0.010          20.9                       4
> watermod$classification
2005 2006 2007 2008 2009 2010 2011 2012 2013 2014 
   1    2    2    2    2    3    3    4    4    5 
2015 2016 2017 2018 2019 
   4    5    4    5    4 