> # Apply Distance matrix model
> fit <- hclust(d, method="ward.D")
> library(NbClust)
> nc <- NbClust(water_scale, distance="euclidean", method="ward.D")
*** : The Hubert index is a graphical method of determining the number of clusters.
                In the plot of Hubert index, we seek a significant knee that corresponds to a 
                significant increase of the value of the measure i.e the significant peak in Hubert
                index second differences plot. 
 
*** : The D index is a graphical method of determining the number of clusters. 
                In the plot of D index, we seek a significant knee (the significant peak in Dindex
                second differences plot) that corresponds to a significant increase of the value of
                the measure. 
 
******************************************************************* 
* Among all indices:                                                
* 6 proposed 2 as the best number of clusters 
* 3 proposed 3 as the best number of clusters 
* 4 proposed 5 as the best number of clusters 
* 3 proposed 6 as the best number of clusters 
* 1 proposed 9 as the best number of clusters 
* 1 proposed 12 as the best number of clusters 
* 5 proposed 15 as the best number of clusters 

                   ***** Conclusion *****                            
 
* According to the majority rule, the best number of clusters is  2 
 
 
******************************************************************* 
Warning messages:
1: In pf(beale, pp, df2) : NaN이 생성되었습니다
2: In pf(beale, pp, df2) : NaN이 생성되었습니다
> nc
$All.index
       KL      CH Hartigan     CCC    Scott      Marriot   TrCovW   TraceW
2  5.1999 14.2468   4.1000 -0.2342  67.5740 1.420931e+10 544.1623 191.8662
3  0.8114  9.9007   4.0419 -1.4612 100.4335 9.887536e+09 403.2116 165.7314
4  0.6295  8.6543   5.8536 -1.9362 139.6080 4.338592e+09 316.9310 142.6659
5  1.0559  9.1398   6.1417 -1.2488 228.0299 2.882037e+08 196.6296 114.6924
6  1.6464 10.0365   4.2199 -0.1399 314.9231 1.863386e+07 122.7406  90.5208
7  1.2185 10.1862   3.7420  0.2970 356.4499 5.755652e+06  81.1439  75.9522
8  1.0520 10.3061   3.8290  0.1649 414.4156 9.484215e+05  65.9872  64.4652
9  1.2758 10.6618   3.2684  0.6855 466.4832 1.869437e+05  49.2863  54.1066
10 1.0015 10.8668   3.5353  0.9408 545.1149 1.391898e+04  36.8029  46.1652
11 1.2251 11.3849   3.1656  1.3877 610.6999 1.618583e+03  26.4754  38.5865
12 1.3161 11.8259   2.6036  1.6593 646.9941 5.269515e+02  18.8069  32.5291
13 1.1241 12.0200   2.4715  1.6272 712.8435 5.887570e+01  15.0523  27.9766
14 1.1058 12.2395   2.3875  1.5385 771.4956 8.405800e+00  12.2699  24.0190
15 1.2588 12.5115   2.0133  1.4136 844.5455 7.103000e-01   7.8420  20.5196
     Friedman   Rubin Cindex     DB Silhouette   Duda Pseudot2   Beale Ratkowsky
2    228.4096  1.5480 0.3238 1.3483     0.3493 0.7660   2.4441  2.0219    0.3921
3    243.8354  1.7921 0.2906 1.5188     0.3470 0.7124   6.4608  2.8296    0.3658
4    297.1819  2.0818 0.2684 1.5366     0.1914 0.6390   2.2597  3.3649    0.3517
5    364.6580  2.5895 0.2612 1.4358     0.2110 0.9387   0.1307  0.3244    0.3427
6    629.7272  3.2810 0.4131 1.1237     0.2625 1.1991  -0.8301 -1.0300    0.3343
7    656.6776  3.9104 0.3771 0.9565     0.2918 1.0527  -0.0500 -0.1863    0.3245
8    824.6664  4.6071 0.3822 0.8127     0.3112 4.4417   0.0000  0.0000    0.3119
9   1156.1747  5.4892 0.4402 0.6924     0.3755 0.7452   3.0776  2.2914    0.3008
10  1638.5470  6.4334 0.3891 0.7547     0.3657 0.5978   4.0376  4.2945    0.2901
11  2013.8084  7.6970 0.4464 0.7213     0.3818 0.9438   0.2383  0.3548    0.2811
12  2085.9833  9.1303 0.4757 0.6812     0.4146 2.4056  -1.1686 -2.9002    0.2723
13  3189.8387 10.6160 0.4535 0.6447     0.4301 1.1538  -0.5333 -0.7941    0.2639
14  5778.6168 12.3652 0.4539 0.6194     0.4504 6.1727   0.0000  0.0000    0.2562
15 18557.2064 14.4739 0.5183 0.5398     0.5096 3.6356  -0.7249 -2.6987    0.2491
      Ball Ptbiserial    Frey McClain   Dunn Hubert SDindex Dindex   SDbw
2  95.9331     0.6263  0.2830  0.5462 0.3292 0.0075  1.3715 2.3827 0.8462
3  55.2438     0.6714  3.8920  0.6637 0.3292 0.0082  1.3381 2.1929 0.7324
4  35.6665     0.4783 -0.1088  1.7498 0.1840 0.0079  1.4736 1.9999 0.6698
5  22.9385     0.5363 -0.1024  1.7721 0.2055 0.0091  1.4532 1.8465 0.6959
6  15.0868     0.5611  0.0830  1.7661 0.3093 0.0094  1.1998 1.6559 0.4676
7  10.8503     0.5754  0.0720  1.8394 0.3093 0.0098  1.1453 1.5049 0.3337
8   8.0582     0.5807  0.0372  1.8615 0.3214 0.0101  1.0228 1.3655 0.2375
9   6.0118     0.5842  1.0538  1.8695 0.3640 0.0105  0.9739 1.2030 0.1216
10  4.6165     0.5020  0.5043  2.8329 0.3640 0.0109  1.1355 1.1137 0.1275
11  3.5079     0.4623  0.2242  3.6013 0.4421 0.0112  1.1097 1.0268 0.1201
12  2.7108     0.4514  0.2408  3.9476 0.5003 0.0117  1.0827 0.9335 0.1022
13  2.1520     0.4426  0.3180  4.2016 0.5107 0.0119  1.0521 0.8506 0.0881
14  1.7156     0.4207  0.1639  4.7880 0.5530 0.0123  1.1025 0.7745 0.0771
15  1.3680     0.4178  0.3284  4.8905 0.6155 0.0123  1.0895 0.6800 0.0512

$All.CriticalValues
   CritValue_Duda CritValue_PseudoT2 Fvalue_Beale
2          0.5268             7.1849       0.0354
3          0.6326             9.2929       0.0020
4          0.4060             5.8524       0.0020
5          0.2855             5.0052       0.9715
6          0.4458             6.2167       1.0000
7          0.1839             4.4371       1.0000
8          0.0135             0.0000          NaN
9          0.5462             7.4785       0.0153
10         0.4778             6.5570       0.0001
11         0.4060             5.8524       0.9666
12         0.2855             5.0052       1.0000
13         0.4060             5.8524       1.0000
14         0.0135             0.0000          NaN
15         0.1839             4.4371       1.0000

$Best.nc
                    KL      CH Hartigan     CCC   Scott    Marriot   TrCovW TraceW
Number_clusters 2.0000  2.0000   6.0000 12.0000  5.0000          5   3.0000  6.000
Value_Index     5.1999 14.2468   1.9218  1.6593 88.4219 3780818347 140.9508  9.603
                Friedman   Rubin Cindex      DB Silhouette  Duda PseudoT2  Beale
Number_clusters    15.00  6.0000 5.0000 15.0000    15.0000 2.000   2.0000 5.0000
Value_Index     12778.59 -0.0621 0.2612  0.5398     0.5096 0.766   2.4441 0.3244
                Ratkowsky    Ball PtBiserial Frey McClain    Dunn Hubert SDindex
Number_clusters    2.0000  3.0000     3.0000    1  2.0000 15.0000      0  9.0000
Value_Index        0.3921 40.6893     0.6714   NA  0.5462  0.6155      0  0.9739
                Dindex    SDbw
Number_clusters      0 15.0000
Value_Index          0  0.0512

$Best.partition
반변천   미천 내성천   금천   영강 병성천   위천   감천 금호강   회천   황강 
     1      1      1      1      1      1      1      1      2      1      1 
  남강 밀양강 송야천 풍산천 광산천   한천   백천 하빈천   차천 신반천 토평천 
     1      1      2      1      1      2      1      2      2      1      2 
계성천 광려천 청도천 주천강 회포천 양산천 
     2      1      1      2      2      2 