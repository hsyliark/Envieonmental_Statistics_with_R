### Reading data
water1 <- read.csv("C:/Users/Nier/Desktop/논문데이터분석(메모추가)/분석자료/csv자료/2_우치(5년).csv", sep=",", header=T)
water1_date <- water1[,1:3]
water1_quality <- water1[,-(1:3)]
## normalization
water1_quality$logTC <- log(water1_quality$TC)
water1_quality$logFC <- log(water1_quality$FC)
water1_quality_1 <- water1_quality[,-11]
water1_quality_1 <- water1_quality_1[,-14]
water_scale <- scale(water1_quality_1)
water1_scale <- cbind(water1_date, water_scale)
water_scale <- as.data.frame(water_scale)
water_scale_1 <- water_scale[,-(1:4)]
water_scale_1 <- water_scale_1[,-(10:11)]
library(psych)
PCA_rot <- principal(water_scale_1, nfactor=2, rotate="varimax", score=T) # varimax rotate
PCA_rot
library(lars)
library(glmnet)
sh <- 10^seq(10,-2,length=100)
lasso <- glmnet(X, y, alpha=1, lambda=sh)
set.seed(1)
cv.lasso <- cv.glmnet(X, y, alpha=1)
plot(cv.lasso)
bestlam.lasso <- cv.lasso$lambda.min
bestlam.lasso
best.lasso <- glmnet(X, y, alpha=1, lambda=sh)
predict(best.lasso, s=bestlam.lasso, type="coefficients")
View(water_scale)
# Lasso (Variation of coefficient with s(threshold))
X <- as.matrix(water_scale[,-6])
y <- as.matrix(water_scale[,6])
object <- lars(X, y, type="lasso")
sh <- 10^seq(10,-2,length=100)
lasso <- glmnet(X, y, alpha=1, lambda=sh)
set.seed(1)
cv.lasso <- cv.glmnet(X, y, alpha=1)
plot(cv.lasso)
bestlam.lasso <- cv.lasso$lambda.min
bestlam.lasso
best.lasso <- glmnet(X, y, alpha=1, lambda=sh)
predict(best.lasso, s=bestlam.lasso, type="coefficients")
### Reading data
water1 <- read.csv("C:/Users/Nier/Desktop/논문데이터분석(메모추가)/분석자료/csv자료/3_광주1(5년).csv", sep=",", header=T)
water1_date <- water1[,1:3]
water1_quality <- water1[,-(1:3)]
## normalization
water1_quality$logTC <- log(water1_quality$TC)
water1_quality$logFC <- log(water1_quality$FC)
water1_quality_1 <- water1_quality[,-11]
water1_quality_1 <- water1_quality_1[,-14]
water_scale <- scale(water1_quality_1)
water1_scale <- cbind(water1_date, water_scale)
water_scale <- as.data.frame(water_scale)
water_scale_1 <- water_scale[,-(1:4)]
water_scale_1 <- water_scale_1[,-(10:11)]
### Reading data
water1 <- read.csv("C:/Users/Nier/Desktop/논문데이터분석(메모추가)/분석자료/csv자료/2_우치(5년).csv", sep=",", header=T)
water1_date <- water1[,1:3]
water1_quality <- water1[,-(1:3)]
## normalization
water1_quality$logTC <- log(water1_quality$TC)
water1_quality$logFC <- log(water1_quality$FC)
water1_quality_1 <- water1_quality[,-11]
water1_quality_1 <- water1_quality_1[,-14]
water_scale <- scale(water1_quality_1)
water1_scale <- cbind(water1_date, water_scale)
water_scale <- as.data.frame(water_scale)
water_scale_1 <- water_scale[,-(1:4)]
water_scale_1 <- water_scale_1[,-(10:11)]
# KMO and Bartlett's test
KMO(water_scale_1)
cortest.bartlett(cor(water_scale_1, method="spearman"), n=nrow(water_scale_1))
### Reading data
water1 <- read.csv("C:/Users/Nier/Desktop/논문데이터분석(메모추가)/분석자료/csv자료/3_광주1(5년).csv", sep=",", header=T)
water1_date <- water1[,1:3]
water1_quality <- water1[,-(1:3)]
## normalization
water1_quality$logTC <- log(water1_quality$TC)
water1_quality$logFC <- log(water1_quality$FC)
water1_quality_1 <- water1_quality[,-11]
water1_quality_1 <- water1_quality_1[,-14]
water_scale <- scale(water1_quality_1)
water1_scale <- cbind(water1_date, water_scale)
water_scale <- as.data.frame(water_scale)
water_scale_1 <- water_scale[,-(1:4)]
water_scale_1 <- water_scale_1[,-(10:11)]
# KMO and Bartlett's test
KMO(water_scale_1)
cortest.bartlett(cor(water_scale_1, method="spearman"), n=nrow(water_scale_1))
PCA_rot <- principal(water_scale_1, nfactor=2, rotate="varimax", score=T) # varimax rotate
PCA_rot
# Lasso (Variation of coefficient with s(threshold))
X <- as.matrix(water_scale[,-6])
y <- as.matrix(water_scale[,6])
object <- lars(X, y, type="lasso")
sh <- 10^seq(10,-2,length=100)
lasso <- glmnet(X, y, alpha=1, lambda=sh)
set.seed(1)
cv.lasso <- cv.glmnet(X, y, alpha=1)
plot(cv.lasso)
bestlam.lasso <- cv.lasso$lambda.min
bestlam.lasso
best.lasso <- glmnet(X, y, alpha=1, lambda=sh)
predict(best.lasso, s=bestlam.lasso, type="coefficients")
### Reading data
water1 <- read.csv("C:/Users/Nier/Desktop/논문데이터분석(메모추가)/분석자료/csv자료/4_광주2(5년).csv", sep=",", header=T)
water1_date <- water1[,1:3]
water1_quality <- water1[,-(1:3)]
## normalization
water1_quality$logTC <- log(water1_quality$TC)
water1_quality$logFC <- log(water1_quality$FC)
water1_quality_1 <- water1_quality[,-11]
water1_quality_1 <- water1_quality_1[,-14]
water_scale <- scale(water1_quality_1)
water1_scale <- cbind(water1_date, water_scale)
water_scale <- as.data.frame(water_scale)
water_scale_1 <- water_scale[,-(1:4)]
water_scale_1 <- water_scale_1[,-(10:11)]
# KMO and Bartlett's test
KMO(water_scale_1)
cortest.bartlett(cor(water_scale_1, method="spearman"), n=nrow(water_scale_1))
PCA_rot <- principal(water_scale_1, nfactor=2, rotate="varimax", score=T) # varimax rotate
PCA_rot
X <- as.matrix(water_scale[,-6])
y <- as.matrix(water_scale[,6])
sh <- 10^seq(10,-2,length=100)
lasso <- glmnet(X, y, alpha=1, lambda=sh)
set.seed(1)
cv.lasso <- cv.glmnet(X, y, alpha=1)
plot(cv.lasso)
bestlam.lasso <- cv.lasso$lambda.min
bestlam.lasso
best.lasso <- glmnet(X, y, alpha=1, lambda=sh)
predict(best.lasso, s=bestlam.lasso, type="coefficients")
### Reading data
water1 <- read.csv("C:/Users/Nier/Desktop/논문데이터분석(메모추가)/분석자료/csv자료/5_광주2-1(5년).csv", sep=",", header=T)
water1_date <- water1[,1:3]
water1_quality <- water1[,-(1:3)]
## normalization
water1_quality$logTC <- log(water1_quality$TC)
water1_quality$logFC <- log(water1_quality$FC)
water1_quality_1 <- water1_quality[,-11]
water1_quality_1 <- water1_quality_1[,-14]
water_scale <- scale(water1_quality_1)
water1_scale <- cbind(water1_date, water_scale)
water_scale <- as.data.frame(water_scale)
water_scale_1 <- water_scale[,-(1:4)]
water_scale_1 <- water_scale_1[,-(10:11)]
# KMO and Bartlett's test
KMO(water_scale_1)
cortest.bartlett(cor(water_scale_1, method="spearman"), n=nrow(water_scale_1))
PCA_rot <- principal(water_scale_1, nfactor=2, rotate="varimax", score=T) # varimax rotate
PCA_rot
X <- as.matrix(water_scale[,-10])
y <- as.matrix(water_scale[,10])
sh <- 10^seq(10,-2,length=100)
lasso <- glmnet(X, y, alpha=1, lambda=sh)
set.seed(1)
cv.lasso <- cv.glmnet(X, y, alpha=1)
plot(cv.lasso)
bestlam.lasso <- cv.lasso$lambda.min
bestlam.lasso
best.lasso <- glmnet(X, y, alpha=1, lambda=sh)
predict(best.lasso, s=bestlam.lasso, type="coefficients")
### Reading data
water1 <- read.csv("C:/Users/Nier/Desktop/논문데이터분석(메모추가)/분석자료/csv자료/6_광산(5년).csv", sep=",", header=T)
water1_date <- water1[,1:3]
water1_quality <- water1[,-(1:3)]
## normalization
water1_quality$logTC <- log(water1_quality$TC)
water1_quality$logFC <- log(water1_quality$FC)
water1_quality_1 <- water1_quality[,-11]
water1_quality_1 <- water1_quality_1[,-14]
water_scale <- scale(water1_quality_1)
water1_scale <- cbind(water1_date, water_scale)
water_scale <- as.data.frame(water_scale)
water_scale_1 <- water_scale[,-(1:4)]
water_scale_1 <- water_scale_1[,-(10:11)]
# KMO and Bartlett's test
KMO(water_scale_1)
cortest.bartlett(cor(water_scale_1, method="spearman"), n=nrow(water_scale_1))
PCA_rot <- principal(water_scale_1, nfactor=2, rotate="varimax", score=T) # varimax rotate
PCA_rot
X <- as.matrix(water_scale[,-6])
y <- as.matrix(water_scale[,6])
sh <- 10^seq(10,-2,length=100)
lasso <- glmnet(X, y, alpha=1, lambda=sh)
set.seed(1)
cv.lasso <- cv.glmnet(X, y, alpha=1)
plot(cv.lasso)
bestlam.lasso <- cv.lasso$lambda.min
bestlam.lasso
best.lasso <- glmnet(X, y, alpha=1, lambda=sh)
predict(best.lasso, s=bestlam.lasso, type="coefficients")
### Reading data
water1 <- read.csv("C:/Users/Nier/Desktop/논문데이터분석(메모추가)/분석자료/csv자료/7_나주(5년).csv", sep=",", header=T)
water1_date <- water1[,1:3]
water1_quality <- water1[,-(1:3)]
## normalization
water1_quality$logTC <- log(water1_quality$TC)
water1_quality$logFC <- log(water1_quality$FC)
water1_quality_1 <- water1_quality[,-11]
water1_quality_1 <- water1_quality_1[,-14]
water_scale <- scale(water1_quality_1)
water1_scale <- cbind(water1_date, water_scale)
water_scale <- as.data.frame(water_scale)
water_scale_1 <- water_scale[,-(1:4)]
water_scale_1 <- water_scale_1[,-(10:11)]
# KMO and Bartlett's test
KMO(water_scale_1)
cortest.bartlett(cor(water_scale_1, method="spearman"), n=nrow(water_scale_1))
PCA_rot <- principal(water_scale_1, nfactor=2, rotate="varimax", score=T) # varimax rotate
PCA_rot
X <- as.matrix(water_scale[,-10])
y <- as.matrix(water_scale[,10])
sh <- 10^seq(10,-2,length=100)
lasso <- glmnet(X, y, alpha=1, lambda=sh)
set.seed(1)
cv.lasso <- cv.glmnet(X, y, alpha=1)
plot(cv.lasso)
bestlam.lasso <- cv.lasso$lambda.min
bestlam.lasso
best.lasso <- glmnet(X, y, alpha=1, lambda=sh)
predict(best.lasso, s=bestlam.lasso, type="coefficients")
### Reading data
water1 <- read.csv("C:/Users/Nier/Desktop/논문데이터분석(메모추가)/분석자료/csv자료/8_영산포(5년).csv", sep=",", header=T)
water1_date <- water1[,1:3]
water1_quality <- water1[,-(1:3)]
## normalization
water1_quality$logTC <- log(water1_quality$TC)
water1_quality$logFC <- log(water1_quality$FC)
water1_quality_1 <- water1_quality[,-11]
water1_quality_1 <- water1_quality_1[,-14]
water_scale <- scale(water1_quality_1)
water1_scale <- cbind(water1_date, water_scale)
water_scale <- as.data.frame(water_scale)
water_scale_1 <- water_scale[,-(1:4)]
water_scale_1 <- water_scale_1[,-(10:11)]
# KMO and Bartlett's test
KMO(water_scale_1)
cortest.bartlett(cor(water_scale_1, method="spearman"), n=nrow(water_scale_1))
PCA_rot <- principal(water_scale_1, nfactor=2, rotate="varimax", score=T) # varimax rotate
PCA_rot
X <- as.matrix(water_scale[,-6])
y <- as.matrix(water_scale[,6])
sh <- 10^seq(10,-2,length=100)
lasso <- glmnet(X, y, alpha=1, lambda=sh)
set.seed(1)
cv.lasso <- cv.glmnet(X, y, alpha=1)
plot(cv.lasso)
bestlam.lasso <- cv.lasso$lambda.min
bestlam.lasso
best.lasso <- glmnet(X, y, alpha=1, lambda=sh)
predict(best.lasso, s=bestlam.lasso, type="coefficients")
### Reading data
water1 <- read.csv("C:/Users/Nier/Desktop/논문데이터분석(메모추가)/분석자료/csv자료/9_죽산(5년).csv", sep=",", header=T)
water1_date <- water1[,1:3]
water1_quality <- water1[,-(1:3)]
## normalization
water1_quality$logTC <- log(water1_quality$TC)
water1_quality$logFC <- log(water1_quality$FC)
water1_quality_1 <- water1_quality[,-11]
water1_quality_1 <- water1_quality_1[,-14]
water_scale <- scale(water1_quality_1)
water1_scale <- cbind(water1_date, water_scale)
water_scale <- as.data.frame(water_scale)
water_scale_1 <- water_scale[,-(1:4)]
water_scale_1 <- water_scale_1[,-(10:11)]
# KMO and Bartlett's test
KMO(water_scale_1)
cortest.bartlett(cor(water_scale_1, method="spearman"), n=nrow(water_scale_1))
PCA_rot <- principal(water_scale_1, nfactor=2, rotate="varimax", score=T) # varimax rotate
PCA_rot
X <- as.matrix(water_scale[,-5])
y <- as.matrix(water_scale[,5])
sh <- 10^seq(10,-2,length=100)
lasso <- glmnet(X, y, alpha=1, lambda=sh)
set.seed(1)
cv.lasso <- cv.glmnet(X, y, alpha=1)
plot(cv.lasso)
bestlam.lasso <- cv.lasso$lambda.min
bestlam.lasso
best.lasso <- glmnet(X, y, alpha=1, lambda=sh)
predict(best.lasso, s=bestlam.lasso, type="coefficients")
### Reading data
water1 <- read.csv("C:/Users/Nier/Desktop/논문데이터분석(메모추가)/분석자료/csv자료/10_영산포-1(5년).csv", sep=",", header=T)
water1_date <- water1[,1:3]
water1_quality <- water1[,-(1:3)]
## normalization
water1_quality$logTC <- log(water1_quality$TC)
water1_quality$logFC <- log(water1_quality$FC)
water1_quality_1 <- water1_quality[,-11]
water1_quality_1 <- water1_quality_1[,-14]
water_scale <- scale(water1_quality_1)
water1_scale <- cbind(water1_date, water_scale)
water_scale <- as.data.frame(water_scale)
water_scale_1 <- water_scale[,-(1:4)]
water_scale_1 <- water_scale_1[,-(10:11)]
# KMO and Bartlett's test
KMO(water_scale_1)
cortest.bartlett(cor(water_scale_1, method="spearman"), n=nrow(water_scale_1))
PCA_rot <- principal(water_scale_1, nfactor=2, rotate="varimax", score=T) # varimax rotate
PCA_rot
X <- as.matrix(water_scale[,-6])
y <- as.matrix(water_scale[,6])
sh <- 10^seq(10,-2,length=100)
lasso <- glmnet(X, y, alpha=1, lambda=sh)
set.seed(1)
cv.lasso <- cv.glmnet(X, y, alpha=1)
plot(cv.lasso)
bestlam.lasso <- cv.lasso$lambda.min
bestlam.lasso
best.lasso <- glmnet(X, y, alpha=1, lambda=sh)
predict(best.lasso, s=bestlam.lasso, type="coefficients")
### Reading data
water1 <- read.csv("C:/Users/Nier/Desktop/논문데이터분석(메모추가)/분석자료/csv자료/11_함평(5년).csv", sep=",", header=T)
water1_date <- water1[,1:3]
water1_quality <- water1[,-(1:3)]
## normalization
water1_quality$logTC <- log(water1_quality$TC)
water1_quality$logFC <- log(water1_quality$FC)
water1_quality_1 <- water1_quality[,-11]
water1_quality_1 <- water1_quality_1[,-14]
water_scale <- scale(water1_quality_1)
water1_scale <- cbind(water1_date, water_scale)
water_scale <- as.data.frame(water_scale)
water_scale_1 <- water_scale[,-(1:4)]
water_scale_1 <- water_scale_1[,-(10:11)]
# KMO and Bartlett's test
KMO(water_scale_1)
cortest.bartlett(cor(water_scale_1, method="spearman"), n=nrow(water_scale_1))
PCA_rot <- principal(water_scale_1, nfactor=2, rotate="varimax", score=T) # varimax rotate
PCA_rot
X <- as.matrix(water_scale[,-12])
y <- as.matrix(water_scale[,12])
sh <- 10^seq(10,-2,length=100)
lasso <- glmnet(X, y, alpha=1, lambda=sh)
set.seed(1)
cv.lasso <- cv.glmnet(X, y, alpha=1)
plot(cv.lasso)
bestlam.lasso <- cv.lasso$lambda.min
bestlam.lasso
best.lasso <- glmnet(X, y, alpha=1, lambda=sh)
predict(best.lasso, s=bestlam.lasso, type="coefficients")
### Reading data
water1 <- read.csv("C:/Users/Nier/Desktop/논문데이터분석(메모추가)/분석자료/csv자료/2_우치(5년).csv", sep=",", header=T)
water1_date <- water1[,1:3]
water1_quality <- water1[,-(1:3)]
## normalization
water1_quality$logTC <- log(water1_quality$TC)
water1_quality$logFC <- log(water1_quality$FC)
water1_quality_1 <- water1_quality[,-11]
water1_quality_1 <- water1_quality_1[,-14]
water_scale <- scale(water1_quality_1)
water1_scale <- cbind(water1_date, water_scale)
water_scale <- as.data.frame(water_scale)
water_scale_1 <- water_scale[,-(1:4)]
water_scale_1 <- water_scale_1[,-(10:11)]
View(water_scale)
View(water_scale_1)
lm(COD~., data=water_scale)
summary(lm(COD~., data=water_scale))
